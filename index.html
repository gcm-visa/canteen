<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ChillEat Canteen App</title>

  <!-- Correct manifest path -->
  <link rel="manifest" href="manifest.json" />
</head>
<body>

<h2>ChillEat App</h2>

<button id="installBtn" style="
  padding: 15px;
  font-size: 18px;
  display: none;
">
  Install ChillEat App
</button>

<script>
let deferredPrompt;

// If already installed â†’ go to redirect page
if (localStorage.getItem("installed") === "yes") {
  window.location.href = "redirect.html";
}

window.addEventListener("beforeinstallprompt", (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById("installBtn").style.display = "block";
});

document.getElementById("installBtn").addEventListener("click", async () => {
  deferredPrompt.prompt();
  const result = await deferredPrompt.userChoice;

  if (result.outcome === "accepted") {
    localStorage.setItem("installed", "yes");
    window.location.href = "redirect.html";
  }
});

// Register service worker
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHILL EAT App</title>
<link rel="manifest" href="/gcm-visa-app/canteen/manifest.json" />
<script defer>
  let deferredPrompt;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;

    // Optionally, show your install button
    document.getElementById('pwaModal').style.display = 'flex';
  });

  document.addEventListener('DOMContentLoaded', () => {
    const installBtn = document.getElementById('installBtn');
    const modal = document.getElementById('pwaModal');
    const closeBtn = document.getElementById('closePwaModal');

    installBtn.addEventListener('click', async () => {
      modal.style.display = 'none';
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        if (choiceResult.outcome === 'accepted') {
          console.log('App installed');
        }
        deferredPrompt = null;
      }
    });

    closeBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });
  });

  // Redirect immediately after installation
  window.addEventListener('appinstalled', () => {
    window.location.href = 'https://script.google.com/macros/s/AKfycbwTWG64jn7L0VDRlN7s3u8_X3MWxb5H_7l0SvvjZ964A_lAnOblCP58kdy4iL18NejGpA/exec?page=c';
  });
</script>
<style>
  body{font-family:sans-serif;margin:0;padding:0;background:#1b5e20;display:flex;justify-content:center;align-items:center;height:100vh;}
  .container{background:rgba(255,255,255,0.9);padding:30px 20px;text-align:center;border-radius:16px;max-width:400px;width:100%;border:1px solid #c8e6c9;}
  .header{background:#fff;color:#2e7d32;padding:12px;font-size:20px;font-weight:bold;border-radius:8px;margin-bottom:16px;box-shadow:inset 0 0 5px rgba(0,0,0,0.1);}
  .button{background:#2e7d32;color:#fff;padding:14px;width:100%;border:none;border-radius:8px;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;gap:10px;cursor:pointer;transition:0.3s;}
  .button:hover{background:#1b5e20;}
  .modal{display:none;position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.4);justify-content:center;align-items:center;}
  .modal-content{background:#fff;padding:30px;border-radius:8px;text-align:center;width:90%;max-width:400px;}
  .modal-header{font-size:20px;margin-bottom:20px;color:#2e7d32;}
  .close{color:#aaa;float:right;font-size:28px;font-weight:bold;cursor:pointer;}
  .close:hover{color:black;}
</style>
</head>
<body>

<div class="container">
  <div class="header">ChilLeat</div>
  <p style="color:rgba(169,169,169,0.8)">Developed by: Elvinson</p>
</div>

<div id="pwaModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closePwaModal">&times;</span>
    <div class="modal-header">Install CHILLEAT App</div>
    <button id="installBtn" class="button"><i class="fas fa-download"></i>Download</button>
  </div>
</div>

</body>
</html>
